{{define "content"}}

<div class="container">

    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item">
            <a class="nav-link" id="config-tab" data-toggle="tab" href="#config" role="tab" aria-controls="config" aria-selected="false">Configuration</a>
        </li>
    </ul>

        <div class="tab-pane" id="config" role="tabpanel" aria-labelledby="config-tab">

            <div class="mt-3 mx-3">
                <form class="mx-auto" style="width: 95%" action="/admin/config" method="POST">

                    {{ range .Config }}
                    <div class="form-group">
                        <label for="conf-{{ .Key }}">{{ .Desc }}</label>
                        {{ if eq .Type "bool" }}
                            <input type="checkbox" id="conf-{{ .Key }}" name="{{ .Key }}" value="{{ .Value }}"
                                {{ if eq .Value "1" }} checked {{ end }}
                                data-toggle="toggle" data-onstyle="primary" data-offstyle="secondary"
                                onchange="this.value = this.checked ? '1' : '0';"
                            />
                        {{ else if eq .Type "int" }}
                            <input type="number" id="conf-{{ .Key }}" name="{{ .Key }}" value="{{ .Value }}" required />
                        {{ else }}
                            <input type="text" id="conf-{{ .Key }}" name="{{ .Key }}" value="{{ .Value }}" required />
                        {{ end }}
                    </div>
                    {{ end }}

                    <button type="submit" class="btn btn-primary">Save</button>
                </form>
            </div>

        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="resetpwModal" tabindex="-1" role="dialog" aria-labelledby="resetpwModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="resetpwModalLabel">Password reset</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Do you really want to reset password for <b class="username"></b>? <br/>
                    This will log them out and force them to choose a new password on their next login
                </div>
                <div class="modal-footer">
                    <form action="/admin/resetpw" method="POST">
                        <input type="hidden" name="username" value="" class="username">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="submit" method="POST" class="btn btn-danger">Reset password</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

</div>

<script type="text/javascript">
    $('#resetpwModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget); // Button that triggered the modal
        var username = button.data('username'); // Extract info from data-* attributes
        var modal = $(this);
        modal.find(".username").text(username);
        modal.find(".username").attr("value", username);
    });

    $('#resetpwModal').on('hidden.bs.modal', function (event) {
        var modal = $(this);
        modal.find(".username").text("");
        modal.find(".username").attr("value", "")
    });

    $(document).ready(function(){
        $('a[data-toggle="tab"]').on('show.bs.tab', function(e) {
            localStorage.setItem('activeTab', $(e.target).attr('href'));
        });
        var activeTab = localStorage.getItem('activeTab');
        if(activeTab){
            $('#myTab a[href="' + activeTab + '"]').tab('show');
        }
    });
</script>

{{ end }}
